import styles from "./SmartToDoList.module.css";
import { useState, type JSX } from "react";
import { useFormik } from "formik";
import * as Yup from "yup";

type Task = {
  id: number;
  text: string;
  completed: boolean;
};

//–û–±—ä—è–≤–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –ø–æ–Ω—è—Ç–Ω—ã–º –∏–º–µ–Ω–µ–º, –∫–æ—Ç–æ—Ä—ã–π
//—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
export default function SmartToDoList(): JSX.Element {
  const [tasks, setTasks] = useState<Task[]>([]);

  // –°—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—è text
  const validationSchema = Yup.object({
    text: Yup.string() //–ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π
      .trim() //–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Ä–µ–∑–∞–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ
      .min(3, "Minimum 3 characters") //–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ 3 —Å–∏–º–≤–æ–ª–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
      .max(50, "Maximum 50 characters") //–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ 50 —Å–∏–º–≤–æ–ª–æ–≤ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
      .required("Enter the text of the task"), //–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–≤–æ–¥–∞
  });

  // Formik
  const formik = useFormik({
    initialValues: { text: "" }, //–ò—Å–ø–æ–ª—å–∑—É–π —Ö—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞–º–∏, –ø–µ—Ä–µ–¥–∞–≤ –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–æ—Ä–º—ã: –ø–æ–ª–µ "text" –∫–∞–∫ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

    //–ü–æ–¥–∫–ª—é—á–∏ —Å–æ–∑–¥–∞–Ω–Ω—É—é —Å—Ö–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    validationSchema,
    onSubmit: (values, { resetForm }) => {
      const newTask: Task = {
        // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
        id: Date.now(),
        text: values.text.trim(),
        completed: false,
      };

      setTasks((prev) => [...prev, newTask]);
      resetForm();
    },
  });

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  // –°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç ID –∑–∞–¥–∞—á–∏,
  // –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á:
  // –ü—Ä–æ–π–¥–∏—Å—å –ø–æ –º–∞—Å—Å–∏–≤—É –∑–∞–¥–∞—á
  // –ù–∞–π–¥–∏ –∑–∞–¥–∞—á—É —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º ID
  // –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É–π –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ "completed"
  // –í–µ—Ä–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
  
  const toggleCompleted = (id: number) => {
    setTasks((prev) =>
      prev.map((t) => (t.id === id ? { ...t, completed: !t.completed } : t))
    );
  };

  // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
  // –°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç ID –∑–∞–¥–∞—á–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
  // –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á:
  // –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π –º–∞—Å—Å–∏–≤, –æ—Å—Ç–∞–≤–∏–≤ —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏, ID –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å  –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º
  // –í–µ—Ä–Ω–∏ –Ω–æ–≤—ã–π –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
  const deleteTask = (id: number) => {
    setTasks((prev) => prev.filter((t) => t.id !== id));
  };

  return (
    //–°–æ–∑–¥–∞–π –∫–æ—Ä–Ω–µ–≤–æ–π div-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ç–∏–ª—è-–æ–±–µ—Ä—Ç–∫
    //–î–æ–±–∞–≤—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å —ç–º–æ–¥–∑–∏ —Å–ø–∏—Å–∫–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ü—Ä–∏–º–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å—Ç–∏–ª—å –∑–∞–≥–æ–ª–æ–≤–∫–∞
    <div className={styles.wrapper}>
      <h1 className={styles.title}>üìù Smart To Do List üìù</h1>
      {/* : –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
–°–æ–∑–¥–∞–π —Ñ–æ—Ä–º—É —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏ —Å—Ç–∏–ª—å —Ñ–æ—Ä–º—ã
–í–Ω—É—Ç—Ä–∏ —Ñ–æ—Ä–º—ã —Ä–∞–∑–º–µ—Å—Ç–∏:
–ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ —Å:
–¢–∏–ø–æ–º "text"
–ò–º–µ–Ω–µ–º "text" (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–º–µ–Ω–∏ –≤ Formik) */}
      <form onSubmit={formik.handleSubmit} className={styles.form}>
        <input
          type="text"
          name="text"
         
          //–ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–º —Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º –∫ –≤–≤–æ–¥—É
          placeholder="Add a new task..."
        
          //–ó–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–æ—Ä–º—ã
          value={formik.values.text}
        
          //–û–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è
          onChange={formik.handleChange}
         
          //–û–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞
          onBlur={formik.handleBlur}

          //–°—Ç–∏–ª–µ–º –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞
          className={styles.input}
        />

        {/* –ö–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã —Å:
–¢–∏–ø–æ–º "submit"
–¢–µ–∫—Å—Ç–æ–º "–î–æ–±–∞–≤–∏—Ç—å"
–°—Ç–∏–ª–µ–º –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */}
        <button type="submit" className={styles.addButton}>
          Add
        </button>
      </form>
    
     {/* ' : –ë–ª–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
–°–æ–∑–¥–∞–π —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö:
–ü–æ–∫–∞–∑—ã–≤–∞–π —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª–µ –±—ã–ª–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ (touched)
–ò –µ—Å—Ç—å –æ—à–∏–±–∫–∞
–û—Ç–æ–±—Ä–∞–∂–∞–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–æ—Ä–º—ã
–ü—Ä–∏–º–µ–Ω–∏ —Å—Ç–∏–ª—å –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö' */}
      {formik.touched.text && formik.errors.text ? (
        <div className={styles.error}>{formik.errors.text}</div>
      ) : null}
      
      {/* : –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
–°–æ–∑–¥–∞–π –Ω–µ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ç–∏–ª—è —Å–ø–∏—Å–∫–∞ */}
      <ul className={styles.list}>
        {/* –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤ –∑–∞–¥–∞—á –ø—É—Å—Ç–æ–π, –ø–æ–∫–∞–∂–∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "–°–ø–∏—Å–æ–∫
–ø—É—Å—Ç" –ü—Ä–∏–º–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å—Ç–∏–ª—å –¥–ª—è –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
*/}
        {tasks.length === 0 ? (
          <p className={styles.empty}>The list is empty</p>
        ) : (
// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
// –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –≤ –º–∞—Å—Å–∏–≤–µ —Å–æ–∑–¥–∞–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ —Å:
// –£–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ ID
// –°—Ç–∏–ª–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞

          tasks.map((task) => (
            <li key={task.id} className={styles.item}>

              {/* : –≠–ª–µ–º–µ–Ω—Ç –∑–∞–¥–∞—á–∏ (—Ç–µ–∫—Å—Ç)
–í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞–π span –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞—á–∏:
–î–æ–±–∞–≤—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–π –∫–ª–∞—Å—Å—ã:
–ë–∞–∑–æ–≤—ã–π —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞—á–∏
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (—É—Å–ª–æ–≤–Ω–æ)
–û—Ç–æ–±—Ä–∞–∂–∞–π —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ */}

              <span
                role="button"
                tabIndex={0}
                onClick={() => toggleCompleted(task.id)}
                onKeyDown={(e) => {
                  if (e.key === "Enter" || e.key === " ")
                    toggleCompleted(task.id);
                }}
                className={`${styles.text} ${
                  task.completed ? styles.completed : ""
                }`}
              >
                {task.text}
              </span>

 {/* –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
–†—è–¥–æ–º —Å —Ç–µ–∫—Å—Ç–æ–º –∑–∞–¥–∞—á–∏ —Ä–∞–∑–º–µ—Å—Ç–∏ –∫–Ω–æ–ø–∫—É:
–¢–∏–ø –∫–Ω–æ–ø–∫–∏ - "button" (—á—Ç–æ–±—ã –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã)
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
–°–∏–º–≤–æ–ª "‚úï" –∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
–°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è */}
              <button
                type="button"
                aria-label={`Delete ${task.text}`}
                className={styles.deleteBtn}
                onClick={() => deleteTask(task.id)}
              >
                ‚úï DELETE
              </button>
            </li>
          ))
        )}
      </ul>
    </div>
  );
}
